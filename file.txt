#include<stdio.h>
#include<stdlib.h>
#include<string.h>

#define MAX 200

struct node{
char text[MAX];
struct node *line;
}node;

struct node *head=NULL;
struct node *tail=NULL;

void add(char *text){
struct node *newnode=(struct node*)malloc(sizeof(node));
strcpy(newnode->text,text);
newnode->line=NULL;
if(head==NULL){
tail=head=newnode;}
else{
tail->line=newnode;
tail=newnode;}}

void display(){
if(head==NULL){
printf("No texts available!");}
struct node *temp=head;
while(temp!=NULL){
printf("%s\n",temp->text);
temp=temp->line;}}

void replace(char *fw,char *rw){
if(head==NULL){
printf("No texts available!");
return;}
struct node *temp=head;
int i=0;
while(temp!=NULL){
char buffer[MAX+100];
char *pos,*start=temp->text;
buffer[0]='\0';
while((pos=strstr(start,fw))!=NULL){
strncat(buffer,start,pos-start);
strcat(buffer,rw);
start=pos+strlen(fw);
i=1;}
strcat(buffer,start);
strcpy(temp->text,buffer);
temp=temp->line;}
if(i==0){
printf("No words matched!\n");}
else{
printf("Successfully replaced!\n");}}

int main(){
int opt;
char text[MAX],fw[50],rw[50];
int m=1;
while(m==1){
printf("\n\n1. Add new line\n");
printf("2. Display\n");
printf("3. Find & Replace\n");
printf("4. Exit\n");
printf("Enter the option:");
scanf("%d",&opt);
getchar();

switch(opt){
case 1:
printf("Enter the line:\n");
fgets(text,sizeof(text),stdin);
text[strcspn(text,"\n")]='\0';
add(text);
break;
case 2:
display();
break;
case 3:
printf("Enter word to find:");
scanf("%s",fw);
printf("Enter word to be replaced:");
scanf("%s",rw);
replace(fw,rw);
break;
case 4:
m=0;
break;
default:
printf("Invalid Option\n");
}}
return 0;}
